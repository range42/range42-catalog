#
# ISSUE 41 
#

#
# STAGE 01 - BUILDER 
#

FROM node:22-slim AS BUILDER
WORKDIR /app
RUN corepack enable && corepack prepare yarn@1.22.22 --activate

COPY package.json ./
RUN yarn add -D vite@2.1.5 && yarn install --frozen-lockfile

COPY vite.config.js ./vite.config.js
COPY index.html ./index.html
COPY src ./src

#
# STAGE 02 - RUNNER 
#

FROM node:22-slim AS RUNNER
WORKDIR /srv/app
RUN corepack enable && corepack prepare yarn@1.22.22 --activate

COPY --from=BUILDER /app/ ./

ENV NODE_ENV=development
EXPOSE 80
CMD ["npx","vite","--host","0.0.0.0","--port","80","--strictPort"]


